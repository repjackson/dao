template(name='alpha_doc_edit')
    with current_doc
        .ui.stackable.padded.grid
            .four.wide.column
                .ui.header editing alpha
                .ui.header #{title}
                a.ui.large.fluid.circular.icon.button(href="/alpha/#{_id}/view")
                    i.checkmark.big.green.icon   
                +print_this
                .ui.header block menu
                each blocks
                    .ui.button.add_module 
                        i.icon(class=icon)
                        |#{title}
            .twelve.wide.column
                // .ui.header modules
                // each old_modules
                //     +module_edit
                .ui.header block modules
                each modules
                    +module_edit
    if is_admin
        +block_editor
        
        
template(name='module_edit')        
    .ui.fluid.segment
        a.ui.header.toggle_section.pointer
            small #{block_title}
            | #{doc_key}:
            |#{alpha_value}
            if viewing_module
                i.chevron.down.small.icon
            else
                i.chevron.right.small.icon
        if viewing_module
            .ui.list
                .item block slug: #{block_slug}
                .item block title: #{block_title}
                .item block id: #{block_id}
                .item doc_key: #{doc_key}
            div
            .ui.input 
                label key
                input.doc_key(type='text' value=doc_key)
            // +text_edit key='doc_key' direct=true
            .ui.small.header module type: #{block_title}
            //- .ui.small.header block slug: #{block_slug}
            +Template.dynamic template=alpha_field_edit
            .ui.icon.button.remove_module
                i.remove.icon

        
        
        
        
        
        
        
template(name='alpha_doc_view')
    with current_doc
        .ui.stackable.padded.grid
            .four.wide.column
                .ui.header #{title}
                a.ui.large.circular.icon.basic.button(href="/alpha/#{_id}/edit")
                    i.pencil.large.icon
                .ui.header #{_author_username}
                +single_user_view key='_author_id'
                // with _author_id
                
                //     +user_card
                +print_this
            .twelve.wide.column
                each modules
                    +module_view


template(name='module_view')
    div        
    .ui.inline.header 
        small #{doc_key}:
    //-     |#{alpha_value}
    //- .ui.header key: #{doc_key}
    //- .ui.small.header module type: #{block_title}
    //- .ui.small.header block slug: #{block_slug}
    +Template.dynamic template=alpha_field_view        
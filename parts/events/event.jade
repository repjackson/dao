template(name='events')
    .ui.stackable.padded.grid 
        .row
            .sixteen.wide.column
                .ui.inline.header
                    +icon name='calendar'
                    |events
                if can_add_event
                    .ui.circular.button.add_event
                        i.plus.icon
                        |add event
                .spacer
                .spacer
                .ui.stackable.four.cards
                    each events
                        +event_card

template(name='event_card')
    a.ui.card(href="/m/event/#{_id}/view")
        if image_id
            a.image.pointer.mobile.hidden(href="/m/event/#{_id}/view")
                img.ui.image(src="{{c.url image_id height=500 width=500 gravity='face' crop='fill'}}")
            a.image.pointer.mobile.only(href="/m/event/#{_id}/view")
                img.ui.image(src="{{c.url image_id height=200 width=500 gravity='center' crop='fill'}}")
        .content
            a.ui.header(href="/event/#{_id}/view") #{title} 
            |{{long_date start_datetime}}
            |- {{long_date end_datetime}}
            .ui.small.grey.inline.header {{from_now start_datetime}}
        .content
            if location
                i.marker.icon 
                |#{location}
            div 
            small added by
            strong #{_author.shortname}
            |#{when}
        .content
            |#{going_user_ids.length}
            i.checkmark.green.icon
            each going
                img.ui.avatar.image(src="{{c.url profile_image_id height=200 width=200 gravity='face' crop='fill'}}")
            i.question.orange.icon
            | #{maybe_user_ids.length}
            each maybe_going
                img.ui.avatar.image(src="{{c.url profile_image_id height=200 width=200 gravity='face' crop='fill'}}")
            | #{not_user_ids.length}
            i.remove.red.icon
            each not_going
                img.ui.avatar.image(src="{{c.url profile_image_id height=200 width=200 gravity='face' crop='fill'}}")
            if is_admin 
                +print_this




template(name='event_edit')
    with current_doc
        .ui.stackable.padded.grid
            .centered.middle.aligned.row 
                .sixteeen.wide.column
                    a.ui.icon.green.big.button(href="/event/#{_id}/view" title='save')
                        i.checkmark.big.icon
                    .ui.inline.header 
                        +icolor name='tear-off-calendar'
                        |edit event
                    .ui.icon.button.delete_item(title='delete')
                        i.large.remove.icon
            .row
                .six.wide.column
                    .ui.header 
                        small author
                        |#{_author.name}
                    +text_edit key='title' label='title' direct=true
                    +slug_edit key='slug' label='slug' icon='slug' direct=true
                    +boolean_edit key='published' label='published' direct=true
                    +datetime_edit key='start_datetime' label='start' direct=true
                    +datetime_edit key='end_datetime' label='end' direct=true
                    .ui.header
                        i.users.icon
                        |audience
                    +number_edit key='max_attendees' label='max attendees' min='0' max='100' direct=true
                    +number_edit key='point_price' label='minimum points per ticket' min='0' max='100' direct=true
                    +number_edit key='usd_price' label='minimum dollars per ticket' min='0' max='100' direct=true
                .ten.wide.column
                    .ui.header room
                    each rooms 
                        .ui.circular.basic.circular.button #{title} 
                    +html_edit key='description' label='description' direct=true
                    +image_edit key='image_id' label='image' direct=true
                    div 
                    +array_edit key='tags' label='tags' direct=true



template(name='gcal_button')
    a.ui.circular.basic.circular.large.button(href="http://www.google.com/calendar/event?action=TEMPLATE&text=#{title}&dates=#{start_datetime}/#{end_datetime}&details=#{description}&location=#{location}" target="_window")
        i.calendar.icon
        |add to gcal
        
        
        
        
template(name='attendance')
    if ticket.length
        .ui.inline.green.header 
            |#{ticket.length} going
    .ui.inline.small.grey.header ticket required
    // .ui.icon.button.pick_going 
    //     i.green.checkmark.big.icon
    // each going 
    //     a.ui.circular.basic.circular.button(href="/user/#{username}")    
    //         img.ui.avatar.compact.image(src="{{c.url profile_image_id height=200 width=200 gravity='face' crop='fill'}}")
    //         |#{username}
    
    .ui.orange.header.pointer.pick_maybe
        // if currentUser
        //     +icolor name='clock' cl='pick_maybe pointer'
        // else
        //     +icolor name='event-accepted-tentatively'
        |#{maybe_going.count} maybe
    // .ui.icon.button.pick_maybe 
    //     i.yellow.minus.big.icon
    each maybe_going
        a.ui.circular.basic.circular.button(href="/user/#{username}")    
            img.ui.avatar.compact.image(src="{{c.url profile_image_id height=200 width=200 gravity='face' crop='fill'}}")
            |#{username}
    .ui.red.header.pointer.pick_not
        // if currentUser
        //     +icolor name='cancel' cl='pick_not pointer'
        // else
        //     +icolor name='event-declined'
        |#{not_going.count} not going
    // .ui.icon.button.pick_not
        // i.big.ban.icon
    each not_going
        a.ui.circular.basic.circular.button(href="/user/#{username}")    
            img.ui.avatar.compact.image(src="{{c.url profile_image_id height=200 width=200 gravity='face' crop='fill'}}")
            |#{username}

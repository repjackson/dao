head
    title dao
    meta(name='viewport', content='user-scalable=yes, initial-scale=1.0, maximum-scale=1.4, width=device-width')
    // meta(name='viewport', content='user-scalable=no, initial-scale=1.0, maximum-scale=1.0, width=device-width')
    meta(name='apple-mobile-web-app-capable', content='yes')
    meta(name='apple-mobile-web-app-status-bar-style', content='black')
    meta(name="msapplication-TileColor" content="#da532c")
    meta(name="theme-color" content="black")
    link(href="https://fonts.googleapis.com/css?family=Ubuntu:300,400&display=swap" rel="stylesheet")
    link(href="https://fonts.googleapis.com/css?family=Roboto:300,400&display=swap" rel="stylesheet")
    //- script(src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js")

    link(rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png")
    link(rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png")
    link(rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png")
    link(rel="manifest" href="/site.webmanifest")

    script(src='https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js')

    link(rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/fomantic-ui@2.8.4/dist/semantic.min.css")
    script(src="https://cdn.jsdelivr.net/npm/fomantic-ui@2.8.4/dist/semantic.min.js")

    // script(src="//embed.redditmedia.com/widgets/platform.js" charset="UTF-8")

    script.
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'UA-156965333-1');

body
    +status
    +home
    

template(name='home')
    .ui.stackable.grid
        .row
            .sixteen.wide.column
                if selected_tags
                    if many_tags
                        a#clear_tags.ui.black.icon.compact.large.circular.button.select_term
                            i.remove.icon
                each selected_tags
                    +unselect_tag
                .ui.left.icon.large.input 
                    i.search.icon
                    input.search_title(type='text' autofocus='')
                each tag_results
                    +tag_selector
                .ui.inline.small.header(title='results') #{doc_count}
                +view_mode key='twitter' icon='twitter'
                +view_mode key='video' icon='youtube'
                +view_mode key='image' icon='picture'
                +view_mode key='reddit' icon='reddit'
                +view_mode key='wikipedia' icon='wikipedia'
                +view_mode key='porn' icon='mercury'
                +view_mode key='stackexchange' icon='stack exchange disabled'
                +view_mode key='github' icon='github disabled'
                +view_mode key='alpha' icon='font'
            .sixteen.wide.column
                .spacer
                each docs
                    if key_value 'model' 'reddit'
                        +reddit
                    else if key_value 'model' 'porn'
                        +vid_card
                    else
                        +post
                    .ui.divider
                    .ui.big.circular.circular.icon.button.vote_up
                        i.thumbs.up.outline.large.icon
                    |#{points}
                    .ui.big.circular.circular.icon.button.vote_down
                        i.thumbs.down.outline.large.icon
                    .ui.big.circular.circular.icon.button.back
                        i.chevron.left.large.icon
                    .ui.big.circular.circular.icon.button.forward
                        i.chevron.right.large.icon
                    each tags
                        a.ui.large.image.label.add_tag
                            if tag_term
                                img.ui.image(src=tag_term.watson.metadata.image)    
                            | #{this}
                    |#{tags.length}
                    .ui.transparent.input
                        i.plus.grey.icon
                        input.tag_post(type='text')


template(name='view_mode')
    i.link.zoomer.icon.toggle_mode(class=toggle_mode_class title=key)

template(name='post')         
    // .ui.fluid.
    // if watson.metadata.image
    //     img.ui.rounded.inline.medium.image.invert(src=watson.metadata.image)    
    // else
    //     img.ui.image(src=url)
    a.ui.header(href=url target='_window' class=post_header_class) #{title}
    .invert.rounded
        iframe.rounded(width="100%" height="500" src=url frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen)
    // iframe.invert(width="100%" height="500" src="https://en.m.wikipedia.org/wiki/#{title}" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen)
                    
template(name='pull_reddit')
    .ui.circular.icon.basic.button.pull
        i.reddit.icon
        
template(name='call_watson')
    .ui.circular.icon.basic.button.pull
        i.dna.icon


template(name='unselect_tag')
    a.unselect_tag.ui.black.large.image.label.zoomer.select_term(href='#')
        if term
            img.ui.avatar.compact.image(src=term.watson.metadata.image)    
        strong #{this}

template(name='tag_selector')
    a.ui.large.image.label.zoomer.pointer.select_tag.select_term(href='#' title="#{count} results")
        if term
            img.ui.avatar.compact.image(src=term.watson.metadata.image)    
        | #{name}
        // small #{count}


template(name='reddit')
    .ui.header(class=post_header_class) #{title}
    div
    if is_image
        img.ui.fluid.image(src=url)
    else if is_youtube
        div
        // .ui.embed
        // iframe(id="ytplayer" type="text/html" width="720" height="405" src="https://www.youtube.com/embed/M7lc1UVf-VE" frameborder="0" allowfullscreen)
        iframe.invert(width="100%" height="600" src="https://www.youtube.com/embed/#{youtube_parse}?autoplay=1" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen)
        // iframe(width="560" height="315" src=url frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen)        
    // .medscroll
    // .invert
    .ui.big.label r/#{subreddit}
    .ui.big.label 
        i.user.outline.icon
        |#{author}
    .ui.big.label
        i.thumbs.up.outline.icon
        |#{ups}
    // .ui.inline.header
    //     | #{url}
    // .spacer
    // .nl2br
    // |!{html}
    .spacer
    // pre
    // .nl2br
    |{{nl2br selftext}}
    div
    |{{nl2br body}}
    // |{{selftext}}
    // blockquote(class="reddit-card")
    //     a(href="https://www.reddit.com#{permalink}") 
    //         |#{title}
    //     |from 
    //     a(href="http://www.reddit.com/r/#{subreddit}") 
    //         |r/#{subreddit}
    // script(src="//embed.redditmedia.com/widgets/platform.js" charset="UTF-8")
    +call_watson
    if watson 
        +watson_view
   
    a.ui.large.circular.button(href=url target='_window' title=url)
        i.external.icon
        |#{domain}
    // unless key_value 'domain'
    i.large.code.link.icon.print_me
    // iframe.invert(width="100%" height="500" src="https://v.redd.it/seckv25qiir51" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen)
    // .ui.icon.circular.button.tagger
    //     i.dna.icon

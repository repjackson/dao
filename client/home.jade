template(name='home')
    .ui.center.aligned.basic.segment
        // .ui.basic.big.compact.button.buy_tiffen
        //     i.gift.icon
        //     |buy tiffen
        .ui.basic.big.compact.icon.button.debit(title='send credit')
            i.send.big.icon
            // |send credit
        // .ui.basic.big.compact.button.request
        //     i.concierge.bell.icon
        //     |request
        .ui.basic.big.compact.icon.button.offer(title='offer')
            i.hand.holding.heart.big.icon
            // |offer
        // .ui.basic.big.compact.button.add_message
        //     i.chat.icon
        //     |message
        // .ui.basic.big.compact.button.add_event
        //     i.calendar.icon
        //     |+ event
        // .ui.basic.big.compact.button.add_expense
        //     i.dollar.icon
        //     |+ expense
        // .ui.basic.big.compact.button.add_bug
        //     i.bug.icon
        //     |+ bug
        a.ui.basic.big.icon.button(href='/register')
            i.user.plus.big.icon
            // |member
        each friends
            if profile_image_id
                a(href="/user/#{username}" title="{{name}} {{points}}")
                    img.ui.tiny.pointer.rounded.inline.spaced_image.zoom.image(src="{{c.url profile_image_id height=200 width=200 gravity='face' crop='fill'}}" class=currentUser.invert_class)
            else 
                a.ui.circular.button(href="/user/#{username}" title="{{name}} {{points}}")
                    |#{username}
                // if avatar_image_id
                // .ui.move.reveal.tiny.spaced_image.image
                //     .visible.content
                //         img(src="{{c.url profile_image_id height=500 width=500 gravity='face' crop='fill'}}") 
                //     .hidden.content
                //         img(src="{{c.url avatar_image_id height=500 width=500 gravity='face' crop='fill'}}") 
                // else
    .ui.stackable.grid
        .two.column.row
            .column
                a.ui.center.aligned.header(href="/m/offer")
                    i.hand.holding.heart.icon
                    |offers
                .ui.stackable.cards.medscroll
                    each latest_offers
                        +home_offer_card
            .column
                // .ui.center.aligned.header
                a.ui.center.aligned.header(href="/m/debit")
                    i.send.icon
                    |transfers
                .ui.stackable.cards.medscroll
                    each latest_debits
                        +debit_card
            // .column
            //     // .ui.center.aligned.header
            //     a.ui.center.aligned.header(href="/m/request")
            //         i.concierge.bell.icon
            //         |requests
            //     .medscroll
            //         each latest_requests
            //             +home_request_card
                    
                    
                    
                                    
template(name='home_request_card')
    .ui.segment.view_request.pointer
        .content
            if youtube_id
                +youtube_view key='youtube_id' direct=true
            else if image_id
                img.ui.raw.image(src="{{c.url image_id width=400 height=300 crop='fill'}}")    

            .header
                .ui.inline.header #{point_bounty}p: #{title}
                if _author.profile_image_id
                    with _author
                        img.ui.avatar.image(src="{{c.url profile_image_id height=500 width=500 gravity='face' crop='fill'}}" class=user_class title=shortname)
                | #{_author.name}
            |!{description}
            .meta #{when}
            // each tags 
            //     .ui.tiny.basic.label #{this}
            if doc_comments.count
                .meta
                    each doc_comments 
                        i.grey.chat.outline.icon
                        img.ui.avatar.image(src="{{c.url _author.profile_image_id height=200 width=200 gravity='face' crop='fill'}}" class=user_class)
                        |#{body}
                        div


                                    
template(name='home_offer_card')
    .ui.card.view_offer.pointer
        .content
            if image_id
                img.ui.raw.image(src="{{c.url image_id width=400 height=300 crop='fill'}}")    
            .header
                .ui.inline.header #{title}
                if _author.profile_image_id
                    with _author
                        img.ui.avatar.image(src="{{c.url profile_image_id height=500 width=500 gravity='face' crop='fill'}}" class=user_class title=shortname)
                | #{_author.name}
            // |!{description}
            .meta #{when}
            if point_price
                |#{point_price}p
            // each tags 
            //     .ui.tiny.basic.label #{this}
            +comments_view_small
            
            
template(name='comments_view_small')            
    if doc_comments.count
        .meta
            each doc_comments 
                i.grey.chat.outline.icon
                img.ui.avatar.image(src="{{c.url _author.profile_image_id height=200 width=200 gravity='face' crop='fill'}}" class=user_class)
                |#{body}
                div


                                    
                                    
template(name='debit_card')
    .ui.card.pointer.view_debit
        if image_id
            img.ui.image(src="{{c.url image_id height=200 width=500 crop='fill'}}")
        .content
            .description 
                if _author.profile_image_id
                    with _author
                        img.ui.avatar.image(src="{{c.url profile_image_id height=500 width=500 gravity='face' crop='fill'}}" class=user_class)
                | #{_author.shortname}
                a.ui.inline.header(href="/debit/#{_id}/view") #{amount}p
                .ui.inline.header >
                if recipient.profile_image_id
                    with recipient
                        img.ui.avatar.image(src="{{c.url profile_image_id height=500 width=500 gravity='face' crop='fill'}}" class=user_class)
                |#{recipient.shortname}
            .meta #{when}
            .description.f11
                |#{description}
            .spacer
            each tags 
                .ui.small.basic.label #{this}
            if upvoter_ids
                +voting_tiny
            +comments_view_small
                                    